import argparse

import socket

def get_file_contents(file_name):
    try:
        # reads img in binary
        with open(file_name, 'rb') as fp:
            return fp.read()
    except:
        # print('File not found!')
        return False
    
parser = argparse.ArgumentParser(description="This is a script to allow you to transfer a file.")
parser.add_argument("-f", "--filename", required= True, help="This gives the name of the file.") # filename
parser.add_argument("-r", "--rhost", required=True, help="The ip address of the host you want to transfer to.", default= "127.0.0.1")
parser.add_argument("-p", "--port", type= int, required=True, help="The port we want to communicate with.", default="4444")


args = parser.parse_args()

file_name =  args.filename
host = args.rhost
port = args.port

# store contents of file
file = get_file_contents(file_name)
if file == False:
        print('File not found! Please try again.')
        exit(1)

s = socket.socket() # creates a socket object 
try: s.connect((host, port))
except: print("Failed to connect to the server! Please try again.")

# send the file
s.send(file)
s.close()
exit(0)
